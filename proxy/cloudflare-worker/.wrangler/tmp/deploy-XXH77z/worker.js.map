{
  "version": 3,
  "sources": ["../../../worker.js"],
  "sourceRoot": "/home/loki/code/Web_Dev/finished projects/answerfinder/proxy/cloudflare-worker/.wrangler/tmp/deploy-XXH77z",
  "sourcesContent": ["export default {\n  /**\n   * Cloudflare Worker Fetch Handler\n   * Acts as a secure proxy to Groq\n   */\n  async fetch(request, env) {\n    const corsHeaders = {\n      \"Access-Control-Allow-Origin\": \"*\", // You should change this to \"chrome-extension://your-id\" later\n      \"Access-Control-Allow-Methods\": \"POST, OPTIONS\",\n      \"Access-Control-Allow-Headers\": \"Content-Type, X-Extension-Key\",\n    };\n\n    // Handle preflight requests\n    if (request.method === \"OPTIONS\") {\n      return new Response(null, { headers: corsHeaders });\n    }\n\n    // Only allow POST\n    if (request.method !== \"POST\") {\n      return new Response(JSON.stringify({ error: \"Method not allowed\" }), {\n        status: 405,\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      });\n    }\n\n    try {\n      const { inputs } = await request.json();\n\n      if (!inputs) {\n        return new Response(JSON.stringify({ error: \"Missing inputs\" }), {\n          status: 400,\n          headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n        });\n      }\n\n      // Proxy to Groq\n      const response = await fetch(\n        \"https://api.groq.com/openai/v1/chat/completions\",\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${env.GROQ_API_KEY}`,\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            model: \"llama-3.3-70b-versatile\",\n            messages: [{ role: \"user\", content: inputs }],\n          }),\n        },\n      );\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        return new Response(\n          JSON.stringify({ error: \"Upstream error\", details: data }),\n          {\n            status: response.status,\n            headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n          },\n        );\n      }\n\n      // Map back to extension format\n      const result = {\n        generated_text:\n          data.choices && data.choices[0]\n            ? data.choices[0].message.content\n            : \"\",\n      };\n\n      return new Response(JSON.stringify(result), {\n        headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n      });\n    } catch (err) {\n      return new Response(\n        JSON.stringify({ error: \"Internal Error\", message: err.message }),\n        {\n          status: 500,\n          headers: { ...corsHeaders, \"Content-Type\": \"application/json\" },\n        },\n      );\n    }\n  },\n};\n"],
  "mappings": ";AAAA,IAAO,iBAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,EAKb,MAAM,MAAM,SAAS,KAAK;AACxB,UAAM,cAAc;AAAA,MAClB,+BAA+B;AAAA;AAAA,MAC/B,gCAAgC;AAAA,MAChC,gCAAgC;AAAA,IAClC;AAGA,QAAI,QAAQ,WAAW,WAAW;AAChC,aAAO,IAAI,SAAS,MAAM,EAAE,SAAS,YAAY,CAAC;AAAA,IACpD;AAGA,QAAI,QAAQ,WAAW,QAAQ;AAC7B,aAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,qBAAqB,CAAC,GAAG;AAAA,QACnE,QAAQ;AAAA,QACR,SAAS,EAAE,GAAG,aAAa,gBAAgB,mBAAmB;AAAA,MAChE,CAAC;AAAA,IACH;AAEA,QAAI;AACF,YAAM,EAAE,OAAO,IAAI,MAAM,QAAQ,KAAK;AAEtC,UAAI,CAAC,QAAQ;AACX,eAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,iBAAiB,CAAC,GAAG;AAAA,UAC/D,QAAQ;AAAA,UACR,SAAS,EAAE,GAAG,aAAa,gBAAgB,mBAAmB;AAAA,QAChE,CAAC;AAAA,MACH;AAGA,YAAM,WAAW,MAAM;AAAA,QACrB;AAAA,QACA;AAAA,UACE,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,eAAe,UAAU,IAAI,YAAY;AAAA,YACzC,gBAAgB;AAAA,UAClB;AAAA,UACA,MAAM,KAAK,UAAU;AAAA,YACnB,OAAO;AAAA,YACP,UAAU,CAAC,EAAE,MAAM,QAAQ,SAAS,OAAO,CAAC;AAAA,UAC9C,CAAC;AAAA,QACH;AAAA,MACF;AAEA,YAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,UAAI,CAAC,SAAS,IAAI;AAChB,eAAO,IAAI;AAAA,UACT,KAAK,UAAU,EAAE,OAAO,kBAAkB,SAAS,KAAK,CAAC;AAAA,UACzD;AAAA,YACE,QAAQ,SAAS;AAAA,YACjB,SAAS,EAAE,GAAG,aAAa,gBAAgB,mBAAmB;AAAA,UAChE;AAAA,QACF;AAAA,MACF;AAGA,YAAM,SAAS;AAAA,QACb,gBACE,KAAK,WAAW,KAAK,QAAQ,CAAC,IAC1B,KAAK,QAAQ,CAAC,EAAE,QAAQ,UACxB;AAAA,MACR;AAEA,aAAO,IAAI,SAAS,KAAK,UAAU,MAAM,GAAG;AAAA,QAC1C,SAAS,EAAE,GAAG,aAAa,gBAAgB,mBAAmB;AAAA,MAChE,CAAC;AAAA,IACH,SAAS,KAAK;AACZ,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,OAAO,kBAAkB,SAAS,IAAI,QAAQ,CAAC;AAAA,QAChE;AAAA,UACE,QAAQ;AAAA,UACR,SAAS,EAAE,GAAG,aAAa,gBAAgB,mBAAmB;AAAA,QAChE;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;",
  "names": []
}
